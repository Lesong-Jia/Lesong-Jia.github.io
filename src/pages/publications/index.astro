---
import { Image } from "astro:assets";
import BaseLayout from "@layouts/BaseLayout.astro";
import { getCollection } from "astro:content";
import siteData from "@config/siteData.json";
import directionMultimodal from "@images/direction-multimodal.png";
import directionRobot from "@images/direction-robot.png";
import directionSituation from "@images/direction-situation.png";
import directionVr from "@images/direction-vr.png";

// 获取所有发表
const allPublications = await getCollection("publications", ({ data }) => data.draft !== true);

// 获取作者位次：1=一作, 2=二作, 3+=其他
function getAuthorPosition(authors: string, authorName: string): number {
	const authorList = authors.split(",").map((a) => a.trim());
	// 检查完整名字匹配（支持 "Lesong Jia" 或 "Jia Lesong" 格式）
	const index = authorList.findIndex((a) => {
		const normalized = a.toLowerCase();
		const nameParts = authorName.toLowerCase().split(" ");
		// 检查是否包含名字的所有部分
		return nameParts.every((part) => normalized.includes(part));
	});
	if (index === -1) return 999; // 未找到，排最后
	if (index === 0) return 1; // 一作
	if (index === 1) return 2; // 二作
	return 3; // 其他位次
}

// 排序：先按作者位次（一作>二作>其他），再按年份（新的在前）
const sortedPublications = allPublications.sort((a, b) => {
	const posA = getAuthorPosition(a.data.authors, siteData.author.name);
	const posB = getAuthorPosition(b.data.authors, siteData.author.name);
	if (posA !== posB) return posA - posB; // 先按位次排序
	return b.data.year - a.data.year; // 再按年份降序
});

// 高亮作者名字
function highlightAuthor(authors: string, name: string): (string | { bold: string })[] {
	if (!name || !authors.includes(name)) return [authors];
	const parts = authors.split(name);
	const out: (string | { bold: string })[] = [];
	parts.forEach((part, i) => {
		out.push(part);
		if (i < parts.length - 1) out.push({ bold: name });
	});
	return out;
}

// 四个研究方向的内容
const researchProjects = [
	{
		title: "多模态交互",
		direction: "多模态交互",
		image: directionMultimodal,
		imageSmall: true,
		imageMaxSize: 88,
		content: `我们的多模态交互研究致力于整合手势、语音、姿态等多种输入通道，构建更加自然、高效的人机交互方式。该研究主要涵盖两个方向：脚本化多模态交互方案设计与自然多模态行为理解。

其中，脚本化多模态交互方案是指由设计者预先制定的交互方式，例如通过特定手势配合语音命令完成目标选择与任务执行。在此类交互中，用户需要遵循既定规则，使用指定的多模态输入向系统传达意图。我们在该方向的研究重点在于探究用户在不同场景与任务下的多模态使用习惯与偏好，并分析用户对不同模态信息的语义理解能力及其编码空间，从而为多种交互功能设计可解释、可学习、可推广的脚本化多模态交互方案。

另一方面，自然多模态行为理解则强调允许用户以更加自由的方式使用多模态行为与系统交互。相比脚本化方案，该方式更加符合用户直觉，交互过程自然流畅，且几乎不存在额外学习成本。然而，这也对多模态行为识别与意图推断算法提出了更高要求。为此，我们从用户自然多模态行为的采集与分析出发，结合传统机器学习方法与大语言模型，构建能够理解自然多模态表达的智能交互模型，以支持更具鲁棒性与泛化能力的人机交互系统。`,
	},
	{
		title: "机器人交互",
		direction: "机器人交互",
		image: directionRobot,
		imageSmall: true,
		imageMaxSize: 90,
		imageOffsetDown: true,
		content: `我们的机器人交互研究关注以用户为中心的沟通机制，旨在通过合理的交互与反馈形式提升机器人系统的可用性、可理解性与可信度，使其更贴合用户需求与使用习惯。

在具体研究中，我们重点探讨用户在与机器人协作完成任务时对功能能力与界面信息呈现的核心期待，并总结用户在交互过程中遇到的主要困难与决策负担。我们通过用户研究分析机器人系统在任务规划、执行反馈、操作透明度与信息呈现方式上的设计要点，并进一步研究不同反馈模态（如视觉、听觉等）在机器人控制与交互中的偏好差异及其对交互效率、工作负荷与用户体验的影响，从而为更自然、更高效的人机协作界面设计提供实证依据与设计建议。

此外，我们将情绪因素作为影响人机交互质量的重要维度，系统研究机器人情绪表达与情绪调节策略对用户感受与行为的作用机制。我们重点探讨不同情绪调节方式（如共情式与非共情式调节）在不同情境下对用户情绪变化、信任形成、建议采纳倾向以及整体交互评价的影响，并通过视频与仿真任务等实验范式建立分析框架，为构建更具社会智能与情感适应能力的机器人交互策略提供理论与实验支持。`,
	},
	{
		title: "态势感知",
		direction: "态势感知",
		image: directionSituation,
		content: `态势感知指的是个体在动态环境中对关键信息的感知、理解以及对未来状态的预测能力。在自动驾驶接管、无人机侦察等高认知负荷、高信息密度的应用场景中，用户是否具备准确的态势感知往往直接影响其决策质量与任务安全性。因此，如何识别并提升用户的态势感知水平成为智能系统设计中的关键问题。我们的研究主要聚焦于两个方向：态势感知状态预测以及通过界面设计提升态势感知水平。

首先，我们构建了一个面向态势感知预测的综合框架，系统性地整合了用户能力、用户状态、用户行为以及场景态势等多类影响因素。在该框架下，我们将用户年龄、性别、驾驶经验等个体差异特征，以及眼动、心电、皮电等生理与行为信号，与环境中关键目标的尺寸、颜色等场景特征相结合，构建态势感知状态预测模型。该模型能够帮助系统识别用户可能缺失或误判的态势信息，并进一步生成针对性的提示与辅助信息，从而支持更及时、更可靠的决策。

进一步地，我们研究不同类型的用户界面在多大程度上能够帮助用户更有效地掌握态势信息。相关研究涵盖界面信息呈现的内容设计、呈现模态（如视觉、听觉或多模态融合）以及信息组织与表达方式等多个维度。通过用户实验与统计分析，我们致力于总结不同任务场景下的界面设计规律，并提出可推广的态势感知辅助界面设计建议，以提升用户的理解效率、降低认知负荷，并增强任务安全性与整体交互体验。`,
	},
	{
		title: "虚拟与增强现实",
		direction: "虚拟与增强现实",
		image: directionVr,
		imageSmall: true,
		imageMaxSize: 97,
		content: `我们在虚拟与增强现实交互领域的研究聚焦于为用户构建更加舒适、高效的沉浸式交互环境，重点关注界面布局优化、虚拟按键尺寸与分布设计，以及不同交互方式下的操作性能与可用性表现。我们通过系统性的用户实验与交互数据分析，评估用户在虚拟环境中完成选择、点击等基础任务时的行为特征与操作效率，提出面向虚拟交互任务的量化评估方法，为VR/AR界面控件设计提供可验证的设计依据与优化方向。

进一步地，我们的研究强调从用户多模态行为数据中理解交互过程与认知状态变化，并基于这些动态信息构建自适应的用户界面。我们结合眼动与手部动作等多模态信号，分析裸手点击与传统控制方式对用户视觉搜索策略、注意分配模式及操作负荷的影响，并探索利用多模态特征预测用户注意状态的建模方法。相关工作为沉浸式系统提供实时用户状态识别与自适应交互支持奠定基础，推动VR/AR交互设计从静态界面优化进一步迈向智能化、个性化与动态调整。`,
	},
];
---

<BaseLayout title="研究方向" description="研究方向。" navStartStyle="default">
	<div class="site-container pt-24 pb-16 md:pt-36 md:pb-24">
		<div class="mb-12 flex flex-wrap items-end justify-between gap-4">
			<h1 class="h2 text-pretty uppercase">研究方向</h1>
			<a
				href="/"
				class="text-sm text-base-600 underline underline-offset-2 hover:text-base-900"
			>
				返回主页
			</a>
		</div>

		<div class="space-y-16">
			{researchProjects.map((project) => (
				<section class="flex flex-col gap-8 md:flex-row md:items-start">
					<!-- 左侧图片 -->
					<div class="w-full shrink-0 md:w-[32rem]">
						<div class="aspect-[4/3] w-full overflow-hidden bg-white md:h-[384px] flex items-center justify-center">
							<Image
								src={project.image}
								alt={project.title}
								width={1280}
								height={960}
								quality={95}
								class={project.imageSmall ? `h-full w-full max-h-[${project.imageMaxSize ?? 85}%] max-w-[${project.imageMaxSize ?? 85}%] object-contain ${project.imageOffsetDown ? "mt-1" : ""}` : "h-full w-full object-cover"}
							/>
						</div>
					</div>

					<!-- 右侧文字内容（可滚动） -->
					<div class="min-w-0 flex-1 flex flex-col md:h-[384px]">
						<h2 class="mb-4 shrink-0 font-heading-2 text-2xl font-medium text-base-900 md:text-3xl">
							{project.title}
						</h2>
						<div class="markdown-content flex-1 pr-2 text-base-700">
							{project.content.split("\n\n").map((paragraph) => (
								<p class="mb-4 leading-relaxed last:mb-0">{paragraph}</p>
							))}

							{/* 相关发表列表 */}
							{(() => {
								const relatedPubs = sortedPublications.filter(
									(entry) => entry.data.direction === project.direction,
								);
								if (relatedPubs.length === 0) return null;
								return (
									<div class="mt-8 border-t border-base-300 pt-6">
										<h3 class="mb-4 font-heading-2 text-lg font-medium text-base-900">
											相关发表
										</h3>
										<ul class="space-y-4">
											{relatedPubs.map((entry) => {
												const { title, authors, venue, year, doi } = entry.data;
												const doiUrl = doi ? `https://doi.org/${doi}` : "";
												return (
													<li class="text-sm">
														<p class="leading-relaxed">
															<span class="font-medium">
																{highlightAuthor(authors, siteData.author.name).map((seg) =>
																	typeof seg === "string" ? seg : <strong>{seg.bold}</strong>
																)}
															</span>. {title}.{" "}
															{venue && <span class="italic">{venue}</span>}
															{year && `, ${year}`}.
														</p>
														{doiUrl && (
															<p class="mt-1">
																<a
																	href={doiUrl}
																	target="_blank"
																	rel="noopener noreferrer"
																	class="text-base-600 underline underline-offset-2 hover:text-base-900"
																>
																	DOI: {doi}
																</a>
															</p>
														)}
													</li>
												);
											})}
										</ul>
									</div>
								);
							})()}
						</div>
					</div>
				</section>
			))}
		</div>
	</div>
</BaseLayout>

<style>
	.markdown-content {
		overflow-y: scroll;
		scrollbar-width: thin;
		scrollbar-color: transparent transparent;
	}

	.markdown-content:hover {
		scrollbar-color: var(--color-base-400) transparent;
	}

	/* Webkit browsers (Chrome, Safari, Edge) */
	.markdown-content::-webkit-scrollbar {
		width: 6px;
	}

	.markdown-content::-webkit-scrollbar-track {
		background: transparent;
	}

	.markdown-content::-webkit-scrollbar-thumb {
		background-color: transparent;
		border-radius: 3px;
		transition: background-color 0.2s ease;
	}

	.markdown-content:hover::-webkit-scrollbar-thumb {
		background-color: var(--color-base-400) !important;
	}

	.markdown-content::-webkit-scrollbar-thumb:hover {
		background-color: var(--color-base-500) !important;
	}

	/* Firefox */
	@-moz-document url-prefix() {
		.markdown-content {
			scrollbar-width: thin;
			scrollbar-color: transparent transparent;
		}

		.markdown-content:hover {
			scrollbar-color: var(--color-base-400) transparent;
		}
	}
</style>
